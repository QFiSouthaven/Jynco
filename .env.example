# =============================================================================
# VIDEO FOUNDRY - ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and configure for your deployment
# Choose your execution mode: production | self-hosted-production | developer

# =============================================================================
# EXECUTION MODE (REQUIRED)
# =============================================================================
# Options: production | self-hosted-production | developer
JYNCO_EXECUTION_MODE=developer

# =============================================================================
# DATABASE
# =============================================================================
DATABASE_URL=postgresql://postgres:password@postgres:5432/videofoundry
POSTGRES_PASSWORD=password  # Change in production!

# =============================================================================
# REDIS
# =============================================================================
REDIS_URL=redis://redis:6379/0
REDIS_PASSWORD=  # Optional password

# =============================================================================
# RABBITMQ
# =============================================================================
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest
SEGMENT_QUEUE_NAME=segment_generation
COMPOSITION_QUEUE_NAME=video_composition

# =============================================================================
# SECRETS MANAGEMENT (VAULT)
# =============================================================================
# Required for production mode, recommended for self-hosted-production
VAULT_ADDR=  # e.g., https://vault.company.com
VAULT_TOKEN=  # Vault authentication token
VAULT_NAMESPACE=videofoundry  # Optional namespace

# =============================================================================
# AUTHENTICATION / IAM
# =============================================================================
# Required for production mode, recommended for self-hosted-production
OIDC_PROVIDER_URL=  # e.g., https://keycloak.company.com/realms/videofoundry
OIDC_CLIENT_ID=  # OAuth2 client ID
OIDC_CLIENT_SECRET=  # OAuth2 client secret
ENABLE_IAM=true  # Set to false only in developer mode

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================
# S3/Object Storage (Required for production, recommended for self-hosted)
S3_BUCKET=video-foundry-dev
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_REGION=us-east-1

# Storage Selection
USE_S3_STORAGE=false  # Auto-determined by execution mode if not set
LOCAL_STORAGE_PATH=/videos  # Used when S3 not configured

# =============================================================================
# AI MODEL APIS
# =============================================================================
RUNWAY_API_KEY=your_runway_api_key
STABILITY_API_KEY=your_stability_api_key
COMFYUI_URL=http://comfyui:8188

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Workflow Security
ENABLE_WORKFLOW_VETTING=true
WORKFLOW_ALLOWLIST_PATH=/config/workflow_allowlist.yaml

# Network Security
ENABLE_NETWORK_ISOLATION=false  # Set to true in production
EGRESS_PROXY_URL=  # Optional proxy for controlled egress (e.g., http://egress_proxy:3128)
EGRESS_ALLOWLIST=github.com,githubusercontent.com,huggingface.co  # Comma-separated domains

# Docker Runtime
DOCKER_RUNTIME=runsc  # Use 'runsc' for gVisor, 'runc' for standard

# =============================================================================
# APPLICATION
# =============================================================================
SECRET_KEY=your-secret-key-change-in-production
ENVIRONMENT=development  # development | self-hosted-production | production
DEBUG=true
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# Frontend
FRONTEND_API_URL=http://localhost:8000

# =============================================================================
# JWT CONFIGURATION
# =============================================================================
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# =============================================================================
# DATABASE PORTS (for external access)
# =============================================================================
POSTGRES_PORT=54321  # External port for PostgreSQL

# =============================================================================
# NOTES
# =============================================================================
# PRODUCTION MODE:
#   - VAULT_ADDR and VAULT_TOKEN are REQUIRED
#   - S3_BUCKET and AWS credentials are REQUIRED
#   - OIDC_PROVIDER_URL is REQUIRED
#   - ENABLE_IAM must be true
#   - System will FAIL to start if requirements not met
#
# SELF-HOSTED PRODUCTION MODE:
#   - Vault RECOMMENDED (warnings if not configured)
#   - S3 RECOMMENDED (warnings if not configured, can use local)
#   - OIDC RECOMMENDED (warnings if not configured, can use basic auth)
#   - System will start with warnings
#
# DEVELOPER MODE:
#   - All security features optional
#   - Secrets can be in .env file (NOT secure!)
#   - Local storage default
#   - IAM optional
#   - DO NOT use in production or on public networks!
